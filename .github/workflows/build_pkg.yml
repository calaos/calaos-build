name: Repository Dispatch

on:
  repository_dispatch:
    types: [build_pkg]

jobs:
  buildEvent:
    runs-on: ubuntu-latest

    steps:
      - name: Import secrets
        run: |
          cat > gpg-key.asc <<- 'EOF'
          ${{ secrets.GPG_PRIVATE_KEY }}
          EOF
          cat > passphrase.txt <<- 'EOF'
          ${{ secrets.GPG_PASSPHRASE }}
          EOF
          cat > upload_token <<- 'EOF'
          ${{ secrets.UPLOAD_TOKEN }}
          EOF
        shell: bash
      - uses: actions/checkout@v2
      - name: debug
        run: echo ${{ github.event.client_payload }}
      - name: make-pkgs-${{ github.event.client_payload.pkgname }}
        run: make build-${{ github.event.client_payload.pkgname }}
